/*
20×20 の格子のうち, 対角線に沿って4つの数字が赤くマークされている.
それらの数字の積は 26 × 63 × 78 × 14 = 1788696 となる.
20×20 の格子のうち, 上下左右斜めのいずれかの方向で連続する4つの数字の積のうち最大のものはいくつか?
*/
WITH sheet(x,y,n) AS (
SELECT 1,1,8 UNION ALL
SELECT 1,2,2 UNION ALL
SELECT 1,3,22 UNION ALL
SELECT 1,4,97 UNION ALL
SELECT 1,5,38 UNION ALL
SELECT 1,6,15 UNION ALL
SELECT 1,7,0 UNION ALL
SELECT 1,8,40 UNION ALL
SELECT 1,9,0 UNION ALL
SELECT 1,10,75 UNION ALL
SELECT 1,11,4 UNION ALL
SELECT 1,12,5 UNION ALL
SELECT 1,13,7 UNION ALL
SELECT 1,14,78 UNION ALL
SELECT 1,15,52 UNION ALL
SELECT 1,16,12 UNION ALL
SELECT 1,17,50 UNION ALL
SELECT 1,18,77 UNION ALL
SELECT 1,19,91 UNION ALL
SELECT 1,20,8 UNION ALL
SELECT 2,1,49 UNION ALL
SELECT 2,2,49 UNION ALL
SELECT 2,3,99 UNION ALL
SELECT 2,4,40 UNION ALL
SELECT 2,5,17 UNION ALL
SELECT 2,6,81 UNION ALL
SELECT 2,7,18 UNION ALL
SELECT 2,8,57 UNION ALL
SELECT 2,9,60 UNION ALL
SELECT 2,10,87 UNION ALL
SELECT 2,11,17 UNION ALL
SELECT 2,12,40 UNION ALL
SELECT 2,13,98 UNION ALL
SELECT 2,14,43 UNION ALL
SELECT 2,15,69 UNION ALL
SELECT 2,16,48 UNION ALL
SELECT 2,17,4 UNION ALL
SELECT 2,18,56 UNION ALL
SELECT 2,19,62 UNION ALL
SELECT 2,20,0 UNION ALL
SELECT 3,1,81 UNION ALL
SELECT 3,2,49 UNION ALL
SELECT 3,3,31 UNION ALL
SELECT 3,4,73 UNION ALL
SELECT 3,5,55 UNION ALL
SELECT 3,6,79 UNION ALL
SELECT 3,7,14 UNION ALL
SELECT 3,8,29 UNION ALL
SELECT 3,9,93 UNION ALL
SELECT 3,10,71 UNION ALL
SELECT 3,11,40 UNION ALL
SELECT 3,12,67 UNION ALL
SELECT 3,13,53 UNION ALL
SELECT 3,14,88 UNION ALL
SELECT 3,15,30 UNION ALL
SELECT 3,16,3 UNION ALL
SELECT 3,17,49 UNION ALL
SELECT 3,18,13 UNION ALL
SELECT 3,19,36 UNION ALL
SELECT 3,20,65 UNION ALL
SELECT 4,1,52 UNION ALL
SELECT 4,2,70 UNION ALL
SELECT 4,3,95 UNION ALL
SELECT 4,4,23 UNION ALL
SELECT 4,5,4 UNION ALL
SELECT 4,6,60 UNION ALL
SELECT 4,7,11 UNION ALL
SELECT 4,8,42 UNION ALL
SELECT 4,9,69 UNION ALL
SELECT 4,10,24 UNION ALL
SELECT 4,11,68 UNION ALL
SELECT 4,12,56 UNION ALL
SELECT 4,13,1 UNION ALL
SELECT 4,14,32 UNION ALL
SELECT 4,15,56 UNION ALL
SELECT 4,16,71 UNION ALL
SELECT 4,17,37 UNION ALL
SELECT 4,18,2 UNION ALL
SELECT 4,19,36 UNION ALL
SELECT 4,20,91 UNION ALL
SELECT 5,1,22 UNION ALL
SELECT 5,2,31 UNION ALL
SELECT 5,3,16 UNION ALL
SELECT 5,4,71 UNION ALL
SELECT 5,5,51 UNION ALL
SELECT 5,6,67 UNION ALL
SELECT 5,7,63 UNION ALL
SELECT 5,8,89 UNION ALL
SELECT 5,9,41 UNION ALL
SELECT 5,10,92 UNION ALL
SELECT 5,11,36 UNION ALL
SELECT 5,12,54 UNION ALL
SELECT 5,13,22 UNION ALL
SELECT 5,14,40 UNION ALL
SELECT 5,15,40 UNION ALL
SELECT 5,16,28 UNION ALL
SELECT 5,17,66 UNION ALL
SELECT 5,18,33 UNION ALL
SELECT 5,19,13 UNION ALL
SELECT 5,20,80 UNION ALL
SELECT 6,1,24 UNION ALL
SELECT 6,2,47 UNION ALL
SELECT 6,3,32 UNION ALL
SELECT 6,4,60 UNION ALL
SELECT 6,5,99 UNION ALL
SELECT 6,6,3 UNION ALL
SELECT 6,7,45 UNION ALL
SELECT 6,8,2 UNION ALL
SELECT 6,9,44 UNION ALL
SELECT 6,10,75 UNION ALL
SELECT 6,11,33 UNION ALL
SELECT 6,12,53 UNION ALL
SELECT 6,13,78 UNION ALL
SELECT 6,14,36 UNION ALL
SELECT 6,15,84 UNION ALL
SELECT 6,16,20 UNION ALL
SELECT 6,17,35 UNION ALL
SELECT 6,18,17 UNION ALL
SELECT 6,19,12 UNION ALL
SELECT 6,20,50 UNION ALL
SELECT 7,1,32 UNION ALL
SELECT 7,2,98 UNION ALL
SELECT 7,3,81 UNION ALL
SELECT 7,4,28 UNION ALL
SELECT 7,5,64 UNION ALL
SELECT 7,6,23 UNION ALL
SELECT 7,7,67 UNION ALL
SELECT 7,8,10 UNION ALL
SELECT 7,9,26 UNION ALL
SELECT 7,10,38 UNION ALL
SELECT 7,11,40 UNION ALL
SELECT 7,12,67 UNION ALL
SELECT 7,13,59 UNION ALL
SELECT 7,14,54 UNION ALL
SELECT 7,15,70 UNION ALL
SELECT 7,16,66 UNION ALL
SELECT 7,17,18 UNION ALL
SELECT 7,18,38 UNION ALL
SELECT 7,19,64 UNION ALL
SELECT 7,20,70 UNION ALL
SELECT 8,1,67 UNION ALL
SELECT 8,2,26 UNION ALL
SELECT 8,3,20 UNION ALL
SELECT 8,4,68 UNION ALL
SELECT 8,5,2 UNION ALL
SELECT 8,6,62 UNION ALL
SELECT 8,7,12 UNION ALL
SELECT 8,8,20 UNION ALL
SELECT 8,9,95 UNION ALL
SELECT 8,10,63 UNION ALL
SELECT 8,11,94 UNION ALL
SELECT 8,12,39 UNION ALL
SELECT 8,13,63 UNION ALL
SELECT 8,14,8 UNION ALL
SELECT 8,15,40 UNION ALL
SELECT 8,16,91 UNION ALL
SELECT 8,17,66 UNION ALL
SELECT 8,18,49 UNION ALL
SELECT 8,19,94 UNION ALL
SELECT 8,20,21 UNION ALL
SELECT 9,1,24 UNION ALL
SELECT 9,2,55 UNION ALL
SELECT 9,3,58 UNION ALL
SELECT 9,4,5 UNION ALL
SELECT 9,5,66 UNION ALL
SELECT 9,6,73 UNION ALL
SELECT 9,7,99 UNION ALL
SELECT 9,8,26 UNION ALL
SELECT 9,9,97 UNION ALL
SELECT 9,10,17 UNION ALL
SELECT 9,11,78 UNION ALL
SELECT 9,12,78 UNION ALL
SELECT 9,13,96 UNION ALL
SELECT 9,14,83 UNION ALL
SELECT 9,15,14 UNION ALL
SELECT 9,16,88 UNION ALL
SELECT 9,17,34 UNION ALL
SELECT 9,18,89 UNION ALL
SELECT 9,19,63 UNION ALL
SELECT 9,20,72 UNION ALL
SELECT 10,1,21 UNION ALL
SELECT 10,2,36 UNION ALL
SELECT 10,3,23 UNION ALL
SELECT 10,4,9 UNION ALL
SELECT 10,5,75 UNION ALL
SELECT 10,6,0 UNION ALL
SELECT 10,7,76 UNION ALL
SELECT 10,8,44 UNION ALL
SELECT 10,9,20 UNION ALL
SELECT 10,10,45 UNION ALL
SELECT 10,11,35 UNION ALL
SELECT 10,12,14 UNION ALL
SELECT 10,13,0 UNION ALL
SELECT 10,14,61 UNION ALL
SELECT 10,15,33 UNION ALL
SELECT 10,16,97 UNION ALL
SELECT 10,17,34 UNION ALL
SELECT 10,18,31 UNION ALL
SELECT 10,19,33 UNION ALL
SELECT 10,20,95 UNION ALL
SELECT 11,1,78 UNION ALL
SELECT 11,2,17 UNION ALL
SELECT 11,3,53 UNION ALL
SELECT 11,4,28 UNION ALL
SELECT 11,5,22 UNION ALL
SELECT 11,6,75 UNION ALL
SELECT 11,7,31 UNION ALL
SELECT 11,8,67 UNION ALL
SELECT 11,9,15 UNION ALL
SELECT 11,10,94 UNION ALL
SELECT 11,11,3 UNION ALL
SELECT 11,12,80 UNION ALL
SELECT 11,13,4 UNION ALL
SELECT 11,14,62 UNION ALL
SELECT 11,15,16 UNION ALL
SELECT 11,16,14 UNION ALL
SELECT 11,17,9 UNION ALL
SELECT 11,18,53 UNION ALL
SELECT 11,19,56 UNION ALL
SELECT 11,20,92 UNION ALL
SELECT 12,1,16 UNION ALL
SELECT 12,2,39 UNION ALL
SELECT 12,3,5 UNION ALL
SELECT 12,4,42 UNION ALL
SELECT 12,5,96 UNION ALL
SELECT 12,6,35 UNION ALL
SELECT 12,7,31 UNION ALL
SELECT 12,8,47 UNION ALL
SELECT 12,9,55 UNION ALL
SELECT 12,10,58 UNION ALL
SELECT 12,11,88 UNION ALL
SELECT 12,12,24 UNION ALL
SELECT 12,13,0 UNION ALL
SELECT 12,14,17 UNION ALL
SELECT 12,15,54 UNION ALL
SELECT 12,16,24 UNION ALL
SELECT 12,17,36 UNION ALL
SELECT 12,18,29 UNION ALL
SELECT 12,19,85 UNION ALL
SELECT 12,20,57 UNION ALL
SELECT 13,1,86 UNION ALL
SELECT 13,2,56 UNION ALL
SELECT 13,3,0 UNION ALL
SELECT 13,4,48 UNION ALL
SELECT 13,5,35 UNION ALL
SELECT 13,6,71 UNION ALL
SELECT 13,7,89 UNION ALL
SELECT 13,8,7 UNION ALL
SELECT 13,9,5 UNION ALL
SELECT 13,10,44 UNION ALL
SELECT 13,11,44 UNION ALL
SELECT 13,12,37 UNION ALL
SELECT 13,13,44 UNION ALL
SELECT 13,14,60 UNION ALL
SELECT 13,15,21 UNION ALL
SELECT 13,16,58 UNION ALL
SELECT 13,17,51 UNION ALL
SELECT 13,18,54 UNION ALL
SELECT 13,19,17 UNION ALL
SELECT 13,20,58 UNION ALL
SELECT 14,1,19 UNION ALL
SELECT 14,2,80 UNION ALL
SELECT 14,3,81 UNION ALL
SELECT 14,4,68 UNION ALL
SELECT 14,5,5 UNION ALL
SELECT 14,6,94 UNION ALL
SELECT 14,7,47 UNION ALL
SELECT 14,8,69 UNION ALL
SELECT 14,9,28 UNION ALL
SELECT 14,10,73 UNION ALL
SELECT 14,11,92 UNION ALL
SELECT 14,12,13 UNION ALL
SELECT 14,13,86 UNION ALL
SELECT 14,14,52 UNION ALL
SELECT 14,15,17 UNION ALL
SELECT 14,16,77 UNION ALL
SELECT 14,17,4 UNION ALL
SELECT 14,18,89 UNION ALL
SELECT 14,19,55 UNION ALL
SELECT 14,20,40 UNION ALL
SELECT 15,1,4 UNION ALL
SELECT 15,2,52 UNION ALL
SELECT 15,3,8 UNION ALL
SELECT 15,4,83 UNION ALL
SELECT 15,5,97 UNION ALL
SELECT 15,6,35 UNION ALL
SELECT 15,7,99 UNION ALL
SELECT 15,8,16 UNION ALL
SELECT 15,9,7 UNION ALL
SELECT 15,10,97 UNION ALL
SELECT 15,11,57 UNION ALL
SELECT 15,12,32 UNION ALL
SELECT 15,13,16 UNION ALL
SELECT 15,14,26 UNION ALL
SELECT 15,15,26 UNION ALL
SELECT 15,16,79 UNION ALL
SELECT 15,17,33 UNION ALL
SELECT 15,18,27 UNION ALL
SELECT 15,19,98 UNION ALL
SELECT 15,20,66 UNION ALL
SELECT 16,1,88 UNION ALL
SELECT 16,2,36 UNION ALL
SELECT 16,3,68 UNION ALL
SELECT 16,4,87 UNION ALL
SELECT 16,5,57 UNION ALL
SELECT 16,6,62 UNION ALL
SELECT 16,7,20 UNION ALL
SELECT 16,8,72 UNION ALL
SELECT 16,9,3 UNION ALL
SELECT 16,10,46 UNION ALL
SELECT 16,11,33 UNION ALL
SELECT 16,12,67 UNION ALL
SELECT 16,13,46 UNION ALL
SELECT 16,14,55 UNION ALL
SELECT 16,15,12 UNION ALL
SELECT 16,16,32 UNION ALL
SELECT 16,17,63 UNION ALL
SELECT 16,18,93 UNION ALL
SELECT 16,19,53 UNION ALL
SELECT 16,20,69 UNION ALL
SELECT 17,1,4 UNION ALL
SELECT 17,2,42 UNION ALL
SELECT 17,3,16 UNION ALL
SELECT 17,4,73 UNION ALL
SELECT 17,5,38 UNION ALL
SELECT 17,6,25 UNION ALL
SELECT 17,7,39 UNION ALL
SELECT 17,8,11 UNION ALL
SELECT 17,9,24 UNION ALL
SELECT 17,10,94 UNION ALL
SELECT 17,11,72 UNION ALL
SELECT 17,12,18 UNION ALL
SELECT 17,13,8 UNION ALL
SELECT 17,14,46 UNION ALL
SELECT 17,15,29 UNION ALL
SELECT 17,16,32 UNION ALL
SELECT 17,17,40 UNION ALL
SELECT 17,18,62 UNION ALL
SELECT 17,19,76 UNION ALL
SELECT 17,20,36 UNION ALL
SELECT 18,1,20 UNION ALL
SELECT 18,2,69 UNION ALL
SELECT 18,3,36 UNION ALL
SELECT 18,4,41 UNION ALL
SELECT 18,5,72 UNION ALL
SELECT 18,6,30 UNION ALL
SELECT 18,7,23 UNION ALL
SELECT 18,8,88 UNION ALL
SELECT 18,9,34 UNION ALL
SELECT 18,10,62 UNION ALL
SELECT 18,11,99 UNION ALL
SELECT 18,12,69 UNION ALL
SELECT 18,13,82 UNION ALL
SELECT 18,14,67 UNION ALL
SELECT 18,15,59 UNION ALL
SELECT 18,16,85 UNION ALL
SELECT 18,17,74 UNION ALL
SELECT 18,18,4 UNION ALL
SELECT 18,19,36 UNION ALL
SELECT 18,20,16 UNION ALL
SELECT 19,1,20 UNION ALL
SELECT 19,2,73 UNION ALL
SELECT 19,3,35 UNION ALL
SELECT 19,4,29 UNION ALL
SELECT 19,5,78 UNION ALL
SELECT 19,6,31 UNION ALL
SELECT 19,7,90 UNION ALL
SELECT 19,8,1 UNION ALL
SELECT 19,9,74 UNION ALL
SELECT 19,10,31 UNION ALL
SELECT 19,11,49 UNION ALL
SELECT 19,12,71 UNION ALL
SELECT 19,13,48 UNION ALL
SELECT 19,14,86 UNION ALL
SELECT 19,15,81 UNION ALL
SELECT 19,16,16 UNION ALL
SELECT 19,17,23 UNION ALL
SELECT 19,18,57 UNION ALL
SELECT 19,19,5 UNION ALL
SELECT 19,20,54 UNION ALL
SELECT 20,1,1 UNION ALL
SELECT 20,2,70 UNION ALL
SELECT 20,3,54 UNION ALL
SELECT 20,4,71 UNION ALL
SELECT 20,5,83 UNION ALL
SELECT 20,6,51 UNION ALL
SELECT 20,7,54 UNION ALL
SELECT 20,8,69 UNION ALL
SELECT 20,9,16 UNION ALL
SELECT 20,10,92 UNION ALL
SELECT 20,11,33 UNION ALL
SELECT 20,12,48 UNION ALL
SELECT 20,13,61 UNION ALL
SELECT 20,14,43 UNION ALL
SELECT 20,15,52 UNION ALL
SELECT 20,16,1 UNION ALL
SELECT 20,17,89 UNION ALL
SELECT 20,18,19 UNION ALL
SELECT 20,19,67 UNION ALL
SELECT 20,20,48
), temp(s,a,b,c,d) AS (

SELECT a.n * b.n * c.n * d.n s, a.n a, b.n b, c.n c, d.n d
FROM
	sheet a
		INNER JOIN
			sheet b
				ON (a.x = b.x AND a.y+1 = b.y)		-- 右方向
		INNER JOIN
			sheet c
				ON (b.x = c.x AND b.y+1 = c.y)		-- 右方向
		INNER JOIN
			sheet d
				ON (c.x = d.x AND c.y+1 = d.y)		-- 右方向
UNION ALL
SELECT a.n * b.n * c.n * d.n s, a.n a, b.n b, c.n c, d.n d
FROM
	sheet a
		INNER JOIN
			sheet b
				ON (a.x+1 = b.x AND a.y = b.y)		-- 下方向
		INNER JOIN
			sheet c
				ON (b.x+1 = c.x AND b.y = c.y)		-- 下方向
		INNER JOIN
			sheet d
				ON (c.x+1 = d.x AND c.y = d.y)		-- 下方向
UNION ALL
SELECT a.n * b.n * c.n * d.n s, a.n a, b.n b, c.n c, d.n d
FROM
	sheet a
		INNER JOIN
			sheet b
				ON (a.x+1 = b.x AND a.y+1 = b.y)		-- 右下方向
		INNER JOIN
			sheet c
				ON (b.x+1 = c.x AND b.y+1 = c.y)		-- 右下方向
		INNER JOIN
			sheet d
				ON (c.x+1 = d.x AND c.y+1 = d.y)		-- 右下方向
UNION ALL
SELECT a.n * b.n * c.n * d.n s, a.n a, b.n b, c.n c, d.n d
FROM
	sheet a
		INNER JOIN
			sheet b
				ON (a.x+1 = b.x AND a.y-1 = b.y)		-- 左下方向
		INNER JOIN
			sheet c
				ON (b.x+1 = c.x AND b.y-1 = c.y)		-- 左下方向
		INNER JOIN
			sheet d
				ON (c.x+1 = d.x AND c.y-1 = d.y)		-- 左下方向
)
SELECT *
FROM temp a
WHERE a.s IN (SELECT MAX(b.s) FROM temp b)
